<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Adding-New-Tests/Test-Case-Example">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="TLS-Anvil RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="TLS-Anvil Atom Feed"><title data-rh="true">Test Template Example | TLS-Anvil</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://tls-anvil.com//docs/Adding-New-Tests/Test-Case-Example"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Test Template Example | TLS-Anvil"><meta data-rh="true" name="description" content="In the following we want to discuss a test template example."><meta data-rh="true" property="og:description" content="In the following we want to discuss a test template example."><link data-rh="true" rel="icon" href="/img/logo-only.png"><link data-rh="true" rel="canonical" href="https://tls-anvil.com//docs/Adding-New-Tests/Test-Case-Example"><link data-rh="true" rel="alternate" href="https://tls-anvil.com//docs/Adding-New-Tests/Test-Case-Example" hreflang="en"><link data-rh="true" rel="alternate" href="https://tls-anvil.com//docs/Adding-New-Tests/Test-Case-Example" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.44122234.css">
<link rel="preload" href="/assets/js/runtime~main.07320164.js" as="script">
<link rel="preload" href="/assets/js/main.cb145cf7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo-only.png" alt="TLS-Anvil Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo-only.png" alt="TLS-Anvil Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">TLS-Anvil</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/Quick-Start/index">Docs</a><a class="navbar__item navbar__link" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/blog">What&#x27;s New</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tls-attacker/TLS-Anvil" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_dLyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/Quick-Start/index">Quick Start</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Architecture">Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/adding-new-tests">Adding New Tests</a><button aria-label="Toggle the collapsible sidebar category &#x27;Adding New Tests&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Adding-New-Tests/Setup-Dev-Environment">Development Environment Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Adding-New-Tests/Test-Case-Example">Test Template Example</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Adding-New-Tests/IPM-Models">Base IPMs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Adding-New-Tests/Modifying-the-IPM-Model">Modifying the IPM</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Potential-Problems">Potential Problems</a></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/adding-new-tests"><span itemprop="name">Adding New Tests</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Test Template Example</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Test Template Example</h1><p>In the following we want to discuss a test template example.
This template aims to test if the <span class="tag_sbMh">SUT<!-- --> ⓘ</span> sends the correct TLS alert, if the CBC padding is incorrect. This test works for client and servers by changing the first application message to use an invalid padding. The template is only executed when the SUT supports a CBC Cipher Suite, otherwise it is skipped. The padding error is injected into multiple positions. The positions are determined by combinatorial testing.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="annotations">Annotations<a class="hash-link" href="#annotations" title="Direct link to heading">​</a></h3><ul><li>Line 1: Generic <code>TlsTest</code> annotation that activates the TLS-Anvil test execution lifecycle. In addition basic parameters are added automatically to the <span class="tag_sbMh">IPM<!-- --> ⓘ</span>.</li><li>Line 5-8: Those annotations modify the IPM<ul><li>Line 5: Changes the default IPM model</li><li>Line 6: Adds additional parameters to the IPM</li><li>Line 7: Adds a constraint to the Cipher Suite parameter of the IPM, so that the test only runs when a CBC Cipher Suite is selected. The <code>isCBC</code> method is called on the TLS-Attacker Cipher Suite enum.</li><li>Line 8: Adds a constraint to the Record Length parameter. The <code>recordLengthAllowsModification</code> method is called on the current class (line 43), given the selected value as argument.</li></ul></li><li>Line 9-13: Each test is annotated with categories and a severity level. Depending on the test result, a score is calculated for each test. Since it is not possible to choose the categories and severity levels objectively, those are not mentioned in our USENIX Security paper.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="test-function">Test function<a class="hash-link" href="#test-function" title="Direct link to heading">​</a></h3><ul><li>Line 15: This is line basically part of every test case, it generates the TLS-Attacker <code>Config</code> that defines how the TLS-Attacker Server/Client should behave (e.g. which algorithms are offered, etc.)</li><li>Line 17-18: An application message is created from which the padding is invalidated. The message that is received from the config is set inside the <code>AppMsgLengthDerivation.applyToConfig</code> method.</li><li>Line 20-24: A bitmask is generated that xored on the padding. During the parameter value generation a byte and bit position is chosen by the combinatorial testing algorithm. From those positions the bitmask is generated during the test execution.</li><li>Line 26-33: A TLS-Attacker <code>WorkflowTrace</code> is generated that performs a complete handshake and sends an application message after the handshake.</li><li>Line 35-41: The WorkflowTrace is scheduled to be sent. After the handshake is completed, the lambda function get&#x27;s executed that determines the test result for a single <span class="tag_sbMh">test case<!-- --> ⓘ</span>. The result of the test template is determined by all test case results.</li></ul><div class="language-java codeBlockContainer_MPoW theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-java codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF codeBlockLinesWithNumbering_hGCP"><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token annotation punctuation" style="color:#393A34">@TlsTest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">description </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Each uint8 in the padding data &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;vector MUST be filled with the padding length value. The receiver &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;MUST check this padding and MUST use the bad_record_mac alert to &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;indicate padding errors.&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ModelFromScope</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">baseModel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">ModelType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CERTIFICATE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ScopeExtensions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">DerivationType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">APP_MSG_LENGHT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">DerivationType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PADDING_BITMASK</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ValueConstraints</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">affectedTypes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">DerivationType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CIPHERSUITE</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> methods </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;isCBC&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@DynamicValueConstraints</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">affectedTypes </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">DerivationType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RECORD_LENGTH</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> methods </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;recordLengthAllowsModification&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@SecurityCategory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SeverityLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HIGH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@CryptoCategory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SeverityLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CRITICAL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@RecordLayerCategory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SeverityLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CRITICAL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@AlertCategory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SeverityLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HIGH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token annotation punctuation" style="color:#393A34">@ComplianceCategory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">SeverityLevel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HIGH</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">invalidCBCPadding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ArgumentsAccessor</span><span class="token plain"> argumentAccessor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">WorkflowRunner</span><span class="token plain"> runner</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token class-name">Config</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getPreparedConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">argumentAccessor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> runner</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token class-name">ApplicationMessage</span><span class="token plain"> appData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ApplicationMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    appData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Modifiable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">explicit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getDefaultApplicationMessageData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getBytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> modificationBitmask </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> derivationContainer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">buildBitmask</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token class-name">Record</span><span class="token plain"> record </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Record</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    record</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setComputations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">RecordCryptoComputations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    record</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getComputations</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setPadding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Modifiable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">xor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">modificationBitmask</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token class-name">SendAction</span><span class="token plain"> sendAction </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">SendAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">appData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    sendAction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setRecords</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token class-name">WorkflowTrace</span><span class="token plain"> workflowTrace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> runner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">generateWorkflowTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">WorkflowTraceType</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">HANDSHAKE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    workflowTrace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">addTlsActions</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">            sendAction</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">ReceiveAction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">AlertMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    runner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">workflowTrace</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">validateFinal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">        </span><span class="token class-name">WorkflowTrace</span><span class="token plain"> trace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getWorkflowTrace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">        </span><span class="token class-name">Validator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">receivedFatalAlert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">        </span><span class="token class-name">AlertMessage</span><span class="token plain"> msg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> trace</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getFirstReceivedMessage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">AlertMessage</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">class</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">        </span><span class="token class-name">Validator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">testAlertDescription</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">AlertDescription</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">BAD_RECORD_MAC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain" style="display:inline-block"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">recordLengthAllowsModification</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Integer</span><span class="token plain"> lengthCandidate</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> lengthCandidate </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span></span><span class="token-line codeLine_rqGN" style="color:#393A34"><span class="codeLineNumber_hzTh"></span><span class="codeLineContent_hM6e"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tls-attacker/TLS-Anvil/tree/main/Docs/docs/05-Adding-New-Tests/02-Test-Case-Example.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Adding-New-Tests/Setup-Dev-Environment"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Development Environment Setup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Adding-New-Tests/IPM-Models"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Base IPMs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#annotations" class="table-of-contents__link toc-highlight">Annotations</a></li><li><a href="#test-function" class="table-of-contents__link toc-highlight">Test function</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a href="https://github.com/tls-attacker/TLS-Anvil" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 TLS-Anvil.<br>Built with <a href="https://docusaurus.io/">Docusaurus</a>, <a href="https://github.com/tls-attacker/TLS-Attacker">TLS-Attacker</a> and <a href="https://coffee4j.github.io/">coffee4j</a>.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.07320164.js"></script>
<script src="/assets/js/main.cb145cf7.js"></script>
</body>
</html>